<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="/css/animate.css" rel="stylesheet" />
  <link href="/css/semantic-ui.css" rel="stylesheet" />
  <link href="/css/style.css" rel="stylesheet" />

  <link href='https://api.tiles.mapbox.com/mapbox.js/v1.6.3/mapbox.css' rel='stylesheet' />
  <title>Data Visualization Capstone</title>
</head>

<body id="map-content" class="loading">

  <div class="ui left vertical sidebar menu">

    <div class="item menu_module" id="aparments_module">

      <div class="menuSection">
        <p class="sectionHeader">Apartments</p>
        <p class="ui_subheader">Explore rent prices in different areas of Boston.</p>
        <div class="ui checkbox">       
          <input type="checkbox" name="apartment" checked>
          <label>Display</label>         
        </div>
      </div>

      <div class="menuSection">
        <p class="rangeTitle">Price</p>
        <p id="currentPrice"></p>
        <input id="price" type="range"> 
      </div> 

      <div class="menuSection">      
        <p>Number of bedrooms</p>
        <div class="ui checkbox">
          <input type="checkbox" name="any_br" checked>
          <label>Any</label>
        </div>          
        <div class="ui checkbox">
          <input type="checkbox" name="1_br">
          <label>1</label>
        </div>
        <div class="ui checkbox">
          <input type="checkbox" name="2_br">
          <label>2</label>
        </div>
        <div class="ui checkbox">
          <input type="checkbox" name="3_br">
          <label>3</label>
        </div>
        <div class="ui checkbox">
          <input type="checkbox" name="4_br">
          <label>4</label>
        </div>
        <div class="ui checkbox">
          <input type="checkbox" name="5_plus_br">
          <label>5+</label>
        </div>                                                        
      </div>

      <div class="menuSection">
        <p class="rangeTitle">Square footage</p>
        <p id="currentFootage"></p>
        <input id="footage" type="range"> 
      </div> 

    </div>

    <div class="item menu_module" id="social_media_module">

      <div class="menuSection">
        <p class="sectionHeader">Social Media</p>
      </div> 

      <div class="menuSection">
        <p class="ui_subheader">Explore what people are posting on Twitter and Instagram around the city be selecting hashtags below</p>
      </div> 

      <div class="menuSection">
        <div class="ui checkbox">       
          <input type="checkbox" name="instagram">
          <label>Display Instagram posts</label>         
        </div>        
      </div> 

      <div class="menuSection">
        <div class="ui checkbox">       
          <input type="checkbox" name="twitter">
          <label>Display Twitter posts</label>         
        </div>        
      </div>

      <div class="menuSection">
        <ul id="hashtags">
          <li class="hashtag active">traffic</li>
          <li class="hashtag">snow</li>
          <li class="hashtag">southend</li>
          <li class="hashtag">patriots</li>
          <li class="hashtag">commuting</li>
          <li class="hashtag">boston</li>
        </ul>
      </div>

      <div class="menuSection">
        <p>Add one custom hashtag to the map</p>
        <div class="ui input">
          <input placeholder="Enter word" id="hashtagInput">
        </div>
        <div class="ui button" id="addHashtagButton" style="background-color:#1b1c1d; color:#fff;">
          Add
        </div>
        <div class="ui button" id="removeHashtagButton" style="background-color:#1b1c1d; color:#fff; display:none;">
          Delete
        </div>          
      </div>

    </div>
    <div class="item menu_module">
      <div class="menuSection">
        <p class="sectionHeader">Additional Information</p>
      </div>
      <div class="menuSection">
        <div class="ui checkbox">       
          <input type="checkbox" name="neighborhoods">
          <label>Boston Neighborhoods</label>         
        </div>        
      </div>
      <div class="menuSection">
        <div class="ui checkbox">       
          <input type="checkbox" name="mbta">
          <label>MBTA Train Map</label>         
        </div>        
      </div>            
    </div>
  </div>
  <div class="pusher">
  <div class="ui secondary button left" onclick="toggleSideNav();" style="top: 20px; right: 20px; z-index: 10001; position: absolute;">Show Menu</div>

  <!-- Leaflet.js map -->
  <div id='map'></div>

  <div id="filterMenu" style="display:none;">
    <div id="fmToggle">
      <a href="javascript:void(0)">
        <h4>Data Filters</h4>
      </a>
    </div>

    <div id="filterMenuBody">
      <div id="filterMenuBodyInner">
        <form action="#">
          <!-- Select Data Sets -->
          <div id="toggles" style="display: none;"></div>
  
          <section id="dateSection">
            <h4>by Date:</h4>

            <!-- Toggle Date Filtering
            <div class="checkbox_outer">
              <input checked type="checkbox" name="date" value="anyDate">
              <label>Any Date</label>
            </div>

            <div class="checkbox_outer">
              <input checked type="checkbox" name="date" value="dateRange">
              <label>Date Range</label>
            </div>-->

            <!-- Filter Data -->
            <div class="demo">
              <input id="date-range" value="" style="width: 100%;">
            </div>


            <div class="divider clear"></div>

            <section id="timeSection">
              <h4>by Time:</h4>

              <div id="slider"></div>

              <div class="divider"></div>

              <h4>MAP TYPE</h4>

              <div class="inputGroup">
                <div class="checkbox_outer">
                  <input type="checkbox" name="time" value="heatmap" checked>
                  <label>Heatmap</label>
                </div>
              </div>

              <div class="inputGroup">
                <div class="checkbox_outer">
                  <input type="checkbox" name="time" value="chronological">
                  <label>Chronological</label>
                </div>
              </div>

              <div class="inputGroup">
                <div class="checkbox_outer">
                  <input type="checkbox" name="time" value="plain">
                  <label>Plain</label>
                </div>
              </div>

            </section>
        </div>
      </form>
    </div>
  </div>

  <div id='loading'></div>
</div>
  <!-- Data Visualization Script -->
  <script src="js/app.js"></script>
  <!-- Load in Sample Data -->
  <script src="js/sample-data.js"></script>
  
  <!-- External -->
  <script src="https://api.tiles.mapbox.com/mapbox.js/v1.6.3/mapbox.js"></script>
  
  <script src='js/heatmap/webgl-heatmap.js'></script>
  <script src='js/heatmap/webgl-heatmap-leaflet.js'></script>
  
  <!-- 
  <script src='js/heatmap/leaflet-d3.js'></script>
  <script src='js/heatmap/hexbin.js'></script>
  -->

  <script>

    /************************************
         Data Visualization Settings
     ************************************/

    // Map settings
    var options = {

      // Mapbox's style key for applying map designs
      map_key: "stephalee.aec4ccea",

      // Define default map viewport: Top left & bottom right coordinates
      viewport: [
        [42.329077, -71.108871],
        [42.374200, -71.032072]
      ],

      // Active data filters
      filters: {

        // Oldest plotted point
        startdate: null,

        // Most recent plotted point
        enddate: null,

      },

      // Support multiple layers of data representation.
      // Useful for building correlations between data sets.
      layers : [],
        
    }

    /************************************
         Add Default Data
     ************************************/

    options.layers.push({
      
      // Set name for layer
      name : "Apartments",

      // Define representation of layer
      type: "scatterplot",

      // Data from sample-data.js
      data : sample_data.apartments,
      
      // Pixel width of scatterplot points
      width: 1,

      color : "#000",
    });

    options.layers.push({
      
      // Set name for layer
      name : "Orange Line",

      // Define representation of layer
      type: "path",

      // Data from sample-data.js
      data : sample_data.subway.orange,
      
      // Pixel width of scatterplot points
      width: 2,

      color: "#ffa500",
    });

    options.layers.push({
      
      // Set name for layer
      name : "Red Line",

      // Define representation of layer
      type: "path",

      // Data from sample-data.js
      data : sample_data.subway.red,
      
      // Pixel width of scatterplot points
      width: 2,

      color: "#ff0000",
    });
  
    options.layers.push({

        // Set name for layer
        name : "Rent Prices",

        // Define representation of layer
        type : "heatmap",

        // Data from sample-data.js
        data : sample_data.apartments,
    });

    /************************************
         Initialize Map
     ************************************/

    // Global variable for map object
    // Initialize Leaflet map
    var leaflet_map = L.mapbox.map('map', options.map_key).fitBounds(options.viewport);

    // Add layers when the map is ready.
    leaflet_map.on('ready', function(){
      addLayers(options.layers);

      console.log("ACTIVE LAYERS");
      console.log(options.layers);
    })

    // Re-add layers when the map has changed.
    leaflet_map.on('viewreset', function(){
      console.log("\nView Reset: Replotting Layers");
      addLayers(options.layers);
    })

  </script>
  <script type="text/javascript">
  
  function toggleSideNav(){
    $('.left.sidebar').sidebar('toggle');
  }
  </script>

  <script type="text/javascript">

    /************************************
         Fix Checkboxs in Side Menu

         - problem with z-index

         - click label instead of checkbox
           to toggle checkbox
     ************************************/

    $("label").click(function(){
        var checkbox = $(this).siblings("input[type=checkbox]").prop("checked");
        if(checkbox == true){
          $(this).siblings("input[type=checkbox]").prop("checked", false);
        } 
        else {
          $(this).siblings("input[type=checkbox]").prop("checked", true);
        }
    });

      /*****************************************************
         Set initial min and max values for price-range slider
     ******************************************************/
    var  priceRange = function(min, max){

      var low = min,
          high = max,
          price = document.getElementById("price");

      price.defaultValue = low;
      price.min = low;
      price.max = high;

      document.getElementById("currentPrice").innerHTML = "" + price.value + "";
    }

    priceRange(500, 4000);

    document.getElementById("price").oninput=function(){
      var current = document.getElementById("price").value;

      document.getElementById("currentPrice").innerHTML = current;

    }

      /*****************************************************
         Set initial min and max values for price-range slider
     ******************************************************/
    var  footageRange = function(min, max){

      var low = min,
          high = max,
          footage = document.getElementById("footage");

      footage.defaultValue = low;
      footage.min = low;
      footage.max = high;

      document.getElementById("currentFootage").innerHTML = "" + footage.value + "";
    }

    footageRange(500, 4000);

    document.getElementById("footage").oninput=function(){

      var current = document.getElementById("footage").value;

      document.getElementById("currentFootage").innerHTML = current;

    }    


      /*****************************************************
         set colors for hashtags
     ******************************************************/

    var colors = ["#57BE6F", "#F3C700", "#3782C2", "#E27B4E", "#564D8C", "#CF2522", "#DB459B", "#038500"],
       hashtags = Array.prototype.slice.call(document.querySelectorAll(".hashtag"));


    for(var i = 0; i < hashtags.length; i++){
    hashtags[i].setAttribute("color", ""+colors[i]+"");
    }

    function colorize(){

      $(".hashtag").each(function(){
        if($(this).hasClass("active")){
          $(this).css("background-color", $(this).attr("color")).css("color", "#fff");
        } else{
          $(this).css("background-color", "#E0E0E0").css("color", "rgba(0,0,0,0.8)");
        }
      });            
    }

    $(".hashtag").click(function(){

      $(this).toggleClass("active");
      colorize();
    });

    $(".hashtag").hover(
      function(){
        if($(this).hasClass("active") != true){
          $(this).css("background-color", $(this).attr("color")).css("color", "#fff");
        }
      },
      function(){
        if($(this).hasClass("active") != true){
          $(this).css("background-color", "#E0E0E0").css("color", "rgba(0,0,0,0.8)");
        }
      }

    );

    colorize();

    /*****************************************************
       Adding a Hashtag to the map
    ******************************************************/

    $("#addHashtagButton").click(function(){
      
    });

  </script>
</body>

</html>