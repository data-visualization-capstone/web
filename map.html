<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="/css/jquery.nouislider.min.css" rel="stylesheet">     
  <link href="/css/styles.css" rel="stylesheet" />
  <link href="/css/map.css" rel="stylesheet" />
  <link href='https://api.tiles.mapbox.com/mapbox.js/v1.6.3/mapbox.css' rel='stylesheet' /> 
</head>
<body class="loading">
  
  <!-- Leaflet.js map -->
  <div id='map'></div>

  <!-- Menu -->

  <div id='selections' class="selections">
    <div class='content'>
      
      <!-- Select Data Sets -->

      <div id="toggles"></div>
<!--       <a href="#" id="toggleConnections">Toggle Connections</a> -->

      <!-- Filter Data -->
<!-- 
      <label>Filter By:</label>
      <select id="month">
        <option>All Months</option>
        <option>1</option>
        <option>2</option>
        <option>3</option>
        <option>4</option>
        <option>5</option>
        <option>6</option>
        <option>7</option>
        <option>8</option>
        <option>9</option>
        <option>10</option>
        <option>11</option>
        <option>12</option>
      </select>
      <select id="day">
        <option>All Days</option>
      </select>
      <div>
        <button id="dateFilter">Filter</button>
        <button onclick="clearFilter()">Clear Filter</button>
      </div> -->
    </div>
  </div>

    <div id="filterMenu">
    <div id="fmToggle">
      <a href="javascript:void(0)">
        <h2>Hide Filters</h2>
      </a>
    </div>
    <div id="fmBody">

      <div id="fmBodyInner">

        <section id="dateSection">

          <h4>DATE FILTERS</h4> 

          <!-- SELECT TO QUERY ALL POINTS -->

          <div class="inputGroup">
            <input checked type="radio" name="date" value="anyDate"> 
            <label>Any Date</label>           
          </div>  

          <!-- SELECT TO QUERY BY DATE RANGE -->

          <div>
            <input type="radio" name="date" value="dateRange">        
            <label>Date Range</label>
          </div>

          <!-- SELECT RANGE FOR POINTS -->

          <div class="inputGroup">

            <div class="dateRangeSelector">
              <label>From</label>
              <input type="date" id="dateFrom">
            </div>

            <div class="dateRangeSelector">
              <label>To</label>
              <input type="date" id="dateTo">
            </div>

          </div>

          <div class="clear"></div>

          <!-- SELECT SPECIFIC MONTH OR YEAR -->

          <div class="inputGroup">
            <input type="radio" name="date" value="monthOrYear">          
            <label>Month or Year</label>
          </div>

          <div class="inputGroup itemLeft">
            <label>Month</label>
            <select id="month">
              <option>Any</option>
              <option>1</option>
              <option>2</option>
              <option>3</option>
              <option>4</option>
              <option>5</option>
              <option>6</option>
              <option>7</option>
              <option>8</option>
              <option>9</option>
              <option>10</option>
              <option>11</option>
              <option>12</option>
            </select>
          </div>  

          <div class="inputGroup itemRight">
            <label>Year</label>
            <select id="month">
              <option>Any</option>
              <option>1</option>
              <option>2</option>
              <option>3</option>
              <option>4</option>
              <option>5</option>
              <option>6</option>
              <option>7</option>
              <option>8</option>
              <option>9</option>
              <option>10</option>
              <option>11</option>
              <option>12</option>
            </select>
          </div>           
        </section>

        <div class="divider clear"></div> 

        <section id="timeSection">
          <h4>TIME FILTERS</h4>

          <div id="slider"></div>          

          <div class="divider clear"></div>

          <div class="inputGroup">
            <input type="radio" name="time" value="heatmap" checked>            
            <label>Heatmap</label>
          </div>

          <div class="inputGroup" style="float:right;">
            <input type="radio" name="time" value="chronological">            
            <label>Chronological</label>
          </div>        

          <div class="inputGroup">
            <input type="radio" name="time" value="plain">            
            <label>Plain</label>
          </div>

        </section>
      </div>
    </div>
  </div>

  <div id='loading'></div>

  <script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.7.0/underscore-min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.8.3/moment.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.4.8/d3.min.js"></script>
  <script src="https://api.tiles.mapbox.com/mapbox.js/v1.6.3/mapbox.js"></script>

  <script src="/lib/xml.min.js"></script>
  <script type="text/javascript" src="js/jquery.nouislider.min.js"></script>

  <script src="/js/data.js"></script>
  <script src="/js/filtering.js"></script>
  <script src="/js/coloring.js"></script>
  <script src="/js/graphing.js"></script>

  <script>

    /****************************
            Settings
     ****************************/
    
    var showConnections = false; // Show travel paths
    //var mapKey = "pk.eyJ1Ijoic3RlcGhhbGVlIiwiYSI6IktPaVp1aHMifQ.rWxRNKSG9I63OQGgJmlhow";
    var mapKey = 'alexjohnson505.k2pknn10'

    /****************************
            Initialize
     ****************************/

    // Load location data.
    loadData(function(data){

      // Initialize Leaflet map
      map = L.mapbox.map('map', mapKey).fitBounds([[42.329077, -71.108871], [42.374200, -71.032072]]);
      
      // Render points on graph
      var data = formatData(data, "time");
      drawPoints(map, data);
    })

    // Initialize slider for time range
    $("#slider").noUiSlider({
      start: [20, 80],
      connect: true,
      range: {
        'min': 0,
        'max': 100
      }
    });

    /****************************
            Interaction
     ****************************/    

    // Show/Hide sequential lines
    $("#toggleConnections").click(function(){
      showConnections = !showConnections;
      d3.selectAll("line").style("opacity", showConnections ? 1 : 0);
    });

    /******************************
             Watchers
     ******************************/

    $("#month").change(function(){
      makeDays($("#month").val());
    });

    $("#dateFilter").click(function(){
      filter($("#month").val(), $("#day").val());
    });



  </script>
</body>
</html>
